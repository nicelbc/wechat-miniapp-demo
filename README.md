# 微信小程序 Demo

这是一个简单的微信小程序示例，展示了小程序的基本结构和功能。

## 项目结构

```
wechat-miniapp-demo/
├── app.json          # 小程序全局配置
├── app.js            # 小程序入口文件
├── app.wxss          # 全局样式
├── sitemap.json      # 搜索引擎配置
├── pages/
│   ├── index/        # 首页
│   │   ├── index.js      # 首页逻辑
│   │   ├── index.wxml    # 首页结构
│   │   ├── index.wxss    # 首页样式
│   │   └── index.json    # 首页配置
│   └── logs/         # 日志页
│       ├── logs.js       # 日志页逻辑
│       ├── logs.wxml     # 日志页结构
│       ├── logs.wxss     # 日志页样式
│       └── logs.json     # 日志页配置
└── README.md         # 说明文档
```

## 功能特性

### 首页 (index)
- ✅ 用户信息获取（微信登录授权）
- ✅ 显示用户头像和昵称
- ✅ 计数器功能（点击按钮增加计数）
- ✅ Toast 提示
- ✅ 跳转到日志页

### 日志页 (logs)
- ✅ 显示本地存储的时间戳日志
- ✅ 格式化日期显示

## 如何使用

### 方式一：在微信开发者工具中打开（推荐）

#### 1. 下载并安装微信开发者工具
- 访问 [微信开发者工具官网](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)
- 根据你的操作系统下载对应版本
- 安装并启动微信开发者工具

#### 2. 导入项目
1. 打开微信开发者工具
2. 点击 "导入项目"
3. 选择项目路径：`/Users/bcl/dir/wechat-miniapp-demo`
4. 点击 "导入"

#### 3. 配置 AppID
1. 在微信开发者工具中，点击右上角的 "详情"
2. 在 "基本信息" 中，点击 "修改" AppID
3. 输入你的微信小程序 AppID（如果没有，可以使用测试号）
   - 测试号申请：在微信开发者工具中点击 "获取测试号"

#### 4. 运行测试
1. 点击开发者工具左上角的 "编译" 按钮
2. 在模拟器中查看小程序运行效果
3. 点击 "获取头像昵称" 按钮进行授权
4. 点击 "点我加1" 按钮测试计数器功能
5. 点击头像或昵称跳转到日志页

### 方式二：使用 GitHub 仓库（远程开发）

#### 1. 克隆仓库
```bash
# 使用 SSH 克隆（推荐）
git clone git@github.com:nicelbc/dir.git

# 或使用 HTTPS 克隆
git clone https://github.com/nicelbc/dir.git
```

#### 2. 进入小程序目录
```bash
cd dir/wechat-miniapp-demo
```

#### 3. 在微信开发者工具中导入
1. 打开微信开发者工具
2. 点击 "导入项目"
3. 选择刚才克隆的目录：`/path/to/dir/wechat-miniapp-demo`
4. 配置 AppID 并运行

### 方式三：直接在本地目录使用

如果你已经在本地有这个目录：
```bash
# 进入小程序目录
cd /Users/bcl/dir/wechat-miniapp-demo

# 查看文件结构
ls -la
```

然后在微信开发者工具中导入该目录即可。

## 详细操作步骤

### 第一步：获取微信小程序 AppID

#### 方法 A：使用正式 AppID
1. 访问 [微信公众平台](https://mp.weixin.qq.com/)
2. 登录你的微信账号
3. 点击 "开发" → "开发管理" → "开发设置"
4. 在 "开发者 ID" 中找到你的 AppID
5. 复制 AppID，在微信开发者工具中配置

#### 方法 B：使用测试号（快速开始）
1. 在微信开发者工具中，点击右上角的 "详情"
2. 在 "基本信息" 中，点击 "获取测试号"
3. 扫描二维码获取测试号信息
4. 使用测试号进行开发和测试

### 第二步：配置开发环境

#### 1. 微信开发者工具设置
- **调试基础库**：建议选择最新稳定版本（如 2.30.0+）
- **ES6 转 ES5**：建议开启（提高兼容性）
- **上传代码时样式自动补全**：建议开启
- **上传代码时变量名自动压缩**：建议开启

#### 2. 项目配置
- **本地设置** → **调试器**：选择 "Console" 或 "Sources"
- **本地设置** → **网络**：选择 "全部" 或根据需要配置
- **本地设置** → **编译**：选择 "自动编译" 或手动编译

### 第三步：运行和调试

#### 1. 基本操作
- **编译**：点击左上角的 "编译" 按钮或按 `Ctrl + B`
- **预览**：点击左上角的 "预览" 按钮生成二维码
- **真机调试**：点击左上角的 "真机调试" 按钮

#### 2. 调试功能
- **Console 控制台**：查看日志输出
- **Sources 源代码**：断点调试
- **Network 网络**：查看网络请求
- **Storage 存储**：查看本地存储数据
- **AppData 数据**：查看实时数据变化

#### 3. 模拟器操作
- **模拟器**：在左侧查看小程序运行效果
- **模拟器设置**：可以模拟不同机型、网络状态等

### 第四步：功能测试

#### 1. 首页功能测试
1. **用户授权测试**：
   - 点击 "获取头像昵称" 按钮
   - 检查是否弹出授权窗口
   - 授权后检查是否正确显示用户信息

2. **计数器测试**：
   - 点击 "点我加1" 按钮
   - 检查计数是否正确增加
   - 检查是否显示 Toast 提示

3. **页面跳转测试**：
   - 点击用户头像或昵称
   - 检查是否跳转到日志页

#### 2. 日志页功能测试
1. **日志显示测试**：
   - 查看是否显示时间戳日志
   - 检查日期格式是否正确

2. **返回测试**：
   - 点击左上角返回按钮
   - 检查是否返回到首页

### 第五步：代码修改和调试

#### 1. 修改代码
- 在微信开发者工具中直接编辑文件
- 保存后自动编译并更新模拟器

#### 2. 调试技巧
- 使用 `console.log()` 输出调试信息
- 使用 `wx.showToast()` 显示提示信息
- 使用 `wx.showModal()` 显示确认对话框

#### 3. 常见问题解决
- **白屏问题**：检查 app.json 配置是否正确
- **样式问题**：检查 wxss 文件是否正确引入
- **逻辑问题**：使用 Sources 面板进行断点调试

## 项目文件详解

### app.json - 全局配置
```json
{
  "pages": ["pages/index/index", "pages/logs/logs"],
  "window": {
    "navigationBarBackgroundColor": "#fff",
    "navigationBarTitleText": "WeChat",
    "navigationBarTextStyle": "black"
  }
}
```

### app.js - 全局逻辑
- `onLaunch()`: 小程序启动时执行
- `globalData`: 全局数据管理
- 用户登录和授权处理

### pages/index/index.js - 首页逻辑
- `onLoad()`: 页面加载时执行
- `getUserInfo()`: 获取用户信息
- `addCount()`: 计数器功能

### pages/logs/logs.js - 日志页逻辑
- `onLoad()`: 页面加载时执行
- 从本地存储读取时间戳
- 格式化显示日期

## 开发建议

### 1. 代码规范
- 使用一致的缩进（2个空格）
- 变量命名使用驼峰命名法
- 添加必要的注释
- 保持代码简洁清晰

### 2. 性能优化
- 避免在循环中调用 API
- 合理使用数据缓存
- 减少不必要的页面跳转
- 优化图片资源大小

### 3. 用户体验
- 添加加载状态提示
- 处理错误情况
- 提供友好的错误提示
- 保持界面简洁美观

### 4. 安全考虑
- 不要在前端存储敏感信息
- 使用 HTTPS 进行网络请求
- 验证用户输入
- 防止 XSS 攻击

## 部署和发布

### 1. 代码上传
1. 在微信开发者工具中点击 "上传"
2. 填写版本号和更新说明
3. 点击 "上传" 按钮

### 2. 提交审核
1. 登录 [微信公众平台](https://mp.weixin.qq.com/)
2. 进入 "开发" → "版本管理"
3. 提交审核并等待审核结果

### 3. 发布上线
1. 审核通过后，点击 "发布"
2. 选择发布范围（全量或灰度）
3. 等待发布完成

## 核心代码说明

### app.js
- 小程序入口文件
- 处理登录和用户信息获取
- 全局数据管理

### index.js
- 首页逻辑
- 用户信息获取和显示
- 计数器功能实现
- 页面跳转

### logs.js
- 日志页逻辑
- 从本地存储读取时间戳
- 格式化显示

## 微信小程序开发要点

### 文件类型
- `.wxml` - 页面结构（类似 HTML）
- `.wxss` - 页面样式（类似 CSS）
- `.js` - 页面逻辑（JavaScript）
- `.json` - 页面配置

### 常用 API
- `wx.login()` - 微信登录
- `wx.getUserInfo()` - 获取用户信息
- `wx.showToast()` - 显示提示
- `wx.navigateTo()` - 页面跳转
- `wx.setStorageSync()` - 本地存储
- `wx.getStorageSync()` - 读取本地存储

### 生命周期
- `onLaunch()` - 小程序初始化
- `onLoad()` - 页面加载
- `onShow()` - 页面显示
- `onHide()` - 页面隐藏

## 开发环境要求

### 必需工具
- **微信开发者工具**：最新版本（推荐 1.06.2301160+）
- **微信小程序 AppID**：正式 AppID 或测试号
- **基础库版本**：2.0.0+（推荐 2.30.0+）

### 操作系统支持
- ✅ Windows 10/11 (64位)
- ✅ macOS 10.15+
- ✅ Ubuntu 18.04+

### 网络要求
- 需要稳定的网络连接
- 需要访问微信服务器（api.weixin.qq.com）
- 建议使用宽带网络，避免使用公共 WiFi

### 账号要求
- **微信账号**：用于登录微信开发者工具
- **小程序账号**：用于获取 AppID（可选，可使用测试号）

## 注意事项

### 开发注意事项
1. **用户授权**：需要用户主动授权才能获取用户信息
2. **本地存储**：数据存储在本地，重启小程序后仍然存在
3. **页面跳转**：使用 `wx.navigateTo()` 进行页面跳转
4. **样式单位**：使用 `rpx` 作为响应式单位
5. **文件命名**：严格区分大小写，避免使用中文文件名
6. **路径配置**：确保 app.json 中的 pages 路径正确

### 调试注意事项
1. **真机调试**：模拟器与真机可能存在差异，建议真机测试
2. **网络请求**：需要配置合法域名（在微信公众平台设置）
3. **用户隐私**：获取用户信息需要用户授权，不能强制获取
4. **版本兼容**：不同基础库版本可能存在 API 差异

### 发布注意事项
1. **代码审核**：确保代码符合微信小程序开发规范
2. **隐私政策**：如果涉及用户数据，需要提供隐私政策
3. **功能测试**：发布前进行全面测试
4. **版本管理**：合理管理版本号和更新说明

### 常见问题
1. **白屏问题**：检查 app.json 配置和页面文件是否存在
2. **样式不生效**：检查 wxss 文件是否正确引入和语法是否正确
3. **API 调用失败**：检查 API 权限和网络连接
4. **授权失败**：检查用户是否已授权，或重新触发授权

## 扩展建议

### 功能扩展
可以在此基础上添加以下功能：
- **网络请求**：`wx.request()` 调用后端 API
- **图片处理**：上传、预览、裁剪图片
- **地图功能**：定位、导航、附近搜索
- **支付功能**：微信支付、订单管理
- **实时通信**：WebSocket、消息推送
- **数据缓存**：本地存储、数据同步
- **用户管理**：登录、注册、个人信息
- **社交功能**：分享、评论、点赞

### 技术栈扩展
- **前端框架**：使用 mpvue、uni-app 等框架
- **状态管理**：使用 Vuex、Redux 等状态管理库
- **UI 组件库**：使用 Vant Weapp、iView Weapp 等组件库
- **构建工具**：使用 Webpack、Gulp 等构建工具

### 部署扩展
- **云开发**：使用微信云开发（CloudBase）
- **服务器部署**：部署到云服务器（阿里云、腾讯云）
- **CDN 加速**：使用 CDN 加速静态资源
- **监控分析**：接入微信数据分析工具

### 学习资源
- [微信官方文档](https://developers.weixin.qq.com/miniprogram/dev/framework/)
- [微信小程序社区](https://developers.weixin.qq.com/community/)
- [微信小程序示例](https://github.com/wechat-miniprogram/miniprogram-demo)
- [微信小程序教程](https://www.bilibili.com/video/BV1nE41117BQ)

---

## 快速开始清单

- [ ] 下载并安装微信开发者工具
- [ ] 导入项目到微信开发者工具
- [ ] 配置 AppID（正式或测试号）
- [ ] 编译并运行小程序
- [ ] 测试首页功能（授权、计数器、跳转）
- [ ] 测试日志页功能（日志显示、返回）
- [ ] 修改代码并调试
- [ ] 真机测试
- [ ] 上传代码并提交审核

---

*创建时间: 2026-02-28*
*作者: Claude Code*
*版本: 1.0.0*